<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report OPENAPI S.P.A.</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }
        h1, h2 {
            text-align: center;
        }
        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .chart-container {
            width: 80%;
            margin: 40px auto;
        }
    </style>
</head>
<body>
    <h1>Report OPENAPI S.P.A.</h1>

    <h2>Dati Anagrafici</h2>
    <table>
        <tr><th>Nome</th><td>OPENAPI S.P.A.</td></tr>
        <tr><th>Codice Fiscale e Partita IVA</th><td>12485671007</td></tr>
        <tr><th>Indirizzo Sede Legale</th><td>VIALE FILIPPO TOMMASO MARINETTI 221, 00143 ROMA (RM)</td></tr>
        <tr><th>Stato Attività</th><td>ATTIVA</td></tr>
        <tr><th>Codice REA</th><td>1378273</td></tr>
        <tr><th>CCIAA</th><td>RM</td></tr>
        <tr><th>Forma Legale</th><td>SOCIETA' PER AZIONI</td></tr>
        <tr><th>Data Inizio Attività</th><td>20-10-2013</td></tr>
        <tr><th>PEC</th><td>openapi@legalmail.it</td></tr>
    </table>

    <h2>Attività</h2>
    <table>
        <tr><th>Codice ATECO</th><td>6201 - Produzione di software non connesso all'edizione</td></tr>
    </table>

    <h2>Soci</h2>
    <table>
        <tr><th>Socio</th><th>Percentuale</th></tr>
        <tr><td>OPEN HOLDING S.R.L.</td><td>100%</td></tr>
    </table>

    <h2>Andamento Finanziario e Personale</h2>
    <div class="chart-container">
        <canvas id="financialChart"></canvas>
    </div>
    <div class="chart-container">
        <canvas id="employeesChart"></canvas>
    </div>

    <h2>Storico Bilanci</h2>
    <table>
        <tr>
            <th>Anno</th>
            <th>Fatturato</th>
            <th>Patrimonio Netto</th>
            <th>Dipendenti</th>
            <th>Costo del Personale</th>
            <th>Totale Attività</th>
        </tr>
        <tr><td>2025</td><td>-</td><td>-</td><td>15</td><td>-</td><td>-</td></tr>
        <tr><td>2024</td><td>3.671.995 €</td><td>338.315 €</td><td>15</td><td>617.428 €</td><td>1.118.403 €</td></tr>
        <tr><td>2023</td><td>3.438.271 €</td><td>-4.710 €</td><td>15</td><td>565.291 €</td><td>1.286.998 €</td></tr>
        <tr><td>2022</td><td>4.043.407 €</td><td>166.491 €</td><td>14</td><td>604.997 €</td><td>1.483.126 €</td></tr>
        <tr><td>2021</td><td>4.432.761 €</td><td>469.366 €</td><td>15</td><td>-</td><td>-</td></tr>
        <tr><td>2020</td><td>4.192.138 €</td><td>170.234 €</td><td>14</td><td>-</td><td>-</td></tr>
        <tr><td>2019</td><td>1.799.587 €</td><td>111.309 €</td><td>14</td><td>-</td><td>-</td></tr>
        <tr><td>2018</td><td>1.325.358 €</td><td>826 €</td><td>-</td><td>-</td><td>-</td></tr>
        <tr><td>2017</td><td>1.120.176 €</td><td>2.928 €</td><td>-</td><td>-</td><td>-</td></tr>
    </table>

    <script>
        const financialData = {
            labels: [2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024],
            datasets: [
                {
                    label: 'Fatturato (€)',
                    data: [1120176, 1325358, 1799587, 4192138, 4432761, 4043407, 3438271, 3671995],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    yAxisID: 'y',
                },
                {
                    label: 'Patrimonio Netto (€)',
                    data: [2928, 826, 111309, 170234, 469366, 166491, -4710, 338315],
                    borderColor: 'rgba(255, 99, 132, 1)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    yAxisID: 'y',
                }
            ]
        };

        const employeesData = {
            labels: [2019, 2020, 2021, 2022, 2023, 2024, 2025],
            datasets: [{
                label: 'Numero Dipendenti',
                data: [14, 14, 15, 14, 15, 15, 15],
                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        };

        const financialConfig = {
            type: 'line',
            data: financialData,
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Andamento Fatturato e Patrimonio Netto (2017-2024)'
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        ticks: {
                            callback: function(value, index, values) {
                                return value.toLocaleString('it-IT', { style: 'currency', currency: 'EUR' });
                            }
                        }
                    }
                }
            }
        };

        const employeesConfig = {
            type: 'bar',
            data: employeesData,
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Andamento Numero Dipendenti (2019-2025)'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        };

        window.onload = function() {
            const financialCtx = document.getElementById('financialChart').getContext('2d');
            new Chart(financialCtx, financialConfig);

            const employeesCtx = document.getElementById('employeesChart').getContext('2d');
            new Chart(employeesCtx, employeesConfig);
        };
    </script>
</body>
</html>